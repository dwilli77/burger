<h1>It's Burger Time!</h1>

<div class="jumbotron">
    <div class="row">
        <div class="col-md-6">
            <div>Click The Burgers to Devour</div>
            <ul>
            {{#each burgers}}
                {{#unless this.devoured}}
                    <li>
                        <button class='burgerAvailable' data-id={{this.id}} data-value={{this.burger_name}}> {{this.burger_name}}</button>
                    </li>
                {{/unless}}
            {{/each}}
            </ul>
        </div>
        <div class="col-md-6">
            <div>Devoured Burgers</div>
            <ul>
            {{#each burgers}}
                {{#if this.devoured}}
                    <div class="devoured-burgers">
                        {{this.burger_name}}
                    </div>
                {{/if}}
            {{/each}}
            </ul>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <form>
                <input type="text" id="burg" name="name" placeholder="Burger Name">
                <button type="submit" class="addBurgerButton">Add The Burger</button>
            </form>
        </div>
    </div>
</div>

<script type="text/javascript">

$(document).on('click', '.burgerAvailable', function(){
    let id = $(this).data('id');
    $.ajax('/api/burger/'+id, {
        type: "PUT",
        data: {
            name: $(this).data('value'),
            devoured: true
            }
    }).then(function(){
        console.log("burger devoured");
        location.reload();
    })
});

$('.addBurgerButton').on('click', function(event){
    event.preventDefault();
    if (!$('#burg').val().trim()){
        return false;
    }
    let newBurger = {
        name: $('#burg').val().trim(),
        devoured: false
    }
    $.ajax('/api/burgers', {
        type: "POST",
        data: newBurger
    }).then(function(){
        console.log('burger created');
        location.reload();
    })
});

</script>